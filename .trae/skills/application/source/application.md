# Application（应用）- 应用实例管理 Skill

## 概述

Application 模块是 Squirrel 平台的核心功能之一，负责管理从应用商店导入的应用实例。它提供了完整的应用生命周期管理能力，包括应用的创建、查看、编辑和删除。

## 功能定位

- **应用实例管理**：从应用商店导入应用模板，创建独立的应用实例
- **应用配置管理**：支持对应用配置进行自定义修改
- **应用生命周期**：完整的 CRUD 操作（创建、读取、更新、删除）
- **部署准备**：为部署模块提供可部署的应用实例

## 核心概念

### 应用实例（Application）
应用实例是从应用商店（App Store）导入的具体应用配置，代表一个可以部署到服务器上的应用。

### 与其他模块的关系

```
App Store（应用模板）
    │
    │ [导入/fork]
    ▼
Application（应用实例）
    │
    │ [部署到服务器]
    ▼
Deployment（部署实例）
    │
    └──> Server（目标服务器）
```

## 功能特性

### 1. 应用列表管理
- 查看所有应用实例
- 显示应用基本信息（名称、描述、类型、版本）
- 支持分页展示

### 2. 应用详情查看
- 查看应用完整配置信息
- 预览应用内容（如 Docker Compose 文件）
- 查看应用类型和版本信息

### 3. 应用创建
- 手动创建新应用实例
- 从应用商店导入并创建应用
- 填写应用基本信息：
  - 名称（name）：应用名称
  - 描述（description）：应用描述
  - 类型（type）：应用类型（如 compose）
  - 内容（content）：应用配置内容
  - 版本（version）：应用版本号

### 4. 应用编辑
- 修改应用配置
- 更新应用内容
- 升级应用版本

### 5. 应用删除
- 删除不再使用的应用实例
- 删除前需确认（防止误删）
- 注意：已部署的应用需要先卸载部署

## 数据模型

### Application 结构

| 字段 | 类型 | 必填 | 说明 |
|------|------|------|------|
| id | uint | 否 | 应用 ID（自动生成） |
| name | string | 是 | 应用名称 |
| description | string | 否 | 应用描述 |
| type | string | 是 | 应用类型（如 compose） |
| content | string | 是 | 应用配置内容 |
| version | string | 否 | 应用版本号 |

### 支持的应用类型

- **compose**：Docker Compose 应用
- **script**：脚本应用
- **binary**：二进制应用（预留）

## 使用场景

### 场景 1：从应用商店导入应用
1. 在应用商店浏览可用的应用模板
2. 选择需要的应用模板（如 Nginx）
3. 点击"导入"按钮，创建应用实例
4. （可选）根据需要修改应用配置
5. 保存应用实例

### 场景 2：手动创建应用
1. 点击"添加应用"按钮
2. 填写应用基本信息
3. 粘贴或编写应用配置内容（如 Docker Compose 文件）
4. 设置应用版本
5. 保存应用实例

### 场景 3：编辑应用配置
1. 在应用列表中找到目标应用
2. 点击"编辑"按钮
3. 修改需要更改的配置项
4. 预览应用内容
5. 保存修改

### 场景 4：删除应用
1. 在应用列表中找到要删除的应用
2. 点击"删除"按钮
3. 确认删除操作
4. 注意：确保该应用没有被部署，否则需要先卸载

## 最佳实践

### 1. 应用命名规范
- 使用小写字母和连字符
- 示例：`nginx-web`, `mysql-db`, `redis-cache`

### 2. 版本管理
- 使用语义化版本号（Semantic Versioning）
- 格式：`主版本号.次版本号.修订号`
- 示例：`1.0.0`, `1.2.3`

### 3. 内容编写规范
- **Compose 应用**：使用标准的 Docker Compose YAML 格式
- **脚本应用**：确保脚本语法正确，支持执行权限
- 添加必要的注释说明配置项用途

### 4. 应用描述
- 提供清晰简洁的应用功能说明
- 说明应用的主要用途和特性
- 列出依赖项和前置条件

### 5. 部署前检查清单
- [ ] 应用配置内容正确无误
- [ ] 环境变量已正确配置
- [ ] 端口映射无冲突
- [ ] 存储卷路径已设置
- [ ] 版本号已更新（如有修改）

## 常见问题

### Q1：应用实例和应用模板有什么区别？
**A**：应用模板（App Store）是可重用的应用配置模板，类似"应用市场"；应用实例（Application）是从模板创建的具体应用配置，每个实例可以独立修改和部署。

### Q2：已部署的应用能否删除？
**A**：不能。需要先在部署模块中卸载所有相关部署，然后才能删除应用实例。

### Q3：如何批量创建相似的应用？
**A**：可以先创建一个应用作为模板，然后使用复制功能（或手动创建）基于它创建新的应用实例，再根据需要修改配置。

### Q4：应用内容验证是如何工作的？
**A**：对于 compose 类型的应用，系统会验证 Docker Compose 文件的语法和格式，确保内容正确才能保存。

### Q5：应用版本管理最佳实践是什么？
**A**：
- 每次重要修改都升级版本号
- 使用语义化版本号（SemVer）
- 在应用描述中记录版本变更内容
- 保留历史版本以便回滚

## 相关 API 文档

详细的 API 接口文档请参考：`application-api.md`

## 相关模块

- **App Store**：应用商店，提供应用模板
- **Deployment**：部署管理，管理应用在服务器上的部署
- **Server**：服务器管理，管理目标服务器
